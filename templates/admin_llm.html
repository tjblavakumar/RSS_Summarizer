{% extends "admin_base.html" %}

{% block admin_content %}
<h3>LLM Configuration</h3>
<p class="text-muted">Configure the AI service for article summarization</p>

<form method="POST" action="{{ url_for('update_llm_config') }}" class="mb-4">
    <div class="mb-3">
        <label for="llm_provider" class="form-label">LLM Provider</label>
        <select class="form-select" name="llm_provider" id="llm_provider" required>
            <option value="bedrock" {% if config.get('llm_provider')=='bedrock' %}selected{% endif %}>AWS Bedrock
            </option>
            <option value="openai" {% if config.get('llm_provider')=='openai' %}selected{% endif %}>OpenAI</option>
            <option value="anthropic" {% if config.get('llm_provider')=='anthropic' %}selected{% endif %}>Anthropic
            </option>
            <option value="custom" {% if config.get('llm_provider')=='custom' %}selected{% endif %}>Custom (OpenAI
                Compatible)</option>
        </select>
        <small class="form-text text-muted">Select your AI provider</small>
    </div>

    <div class="mb-3">
        <label for="llm_api_key" class="form-label">API Key</label>
        <input type="password" class="form-control" name="llm_api_key" id="llm_api_key"
            value="{{ config.get('llm_api_key', '') }}"
            placeholder="Enter API key (leave empty for AWS Bedrock with IAM)">
        <small class="form-text text-muted">Your API key (not required for AWS Bedrock with IAM credentials)</small>
    </div>

    <div class="mb-3">
        <label for="llm_model" class="form-label">Model ID</label>
        <input type="text" class="form-control" name="llm_model" id="llm_model"
            value="{{ config.get('llm_model', 'anthropic.claude-3-haiku-20240307-v1:0') }}" required>
        <small class="form-text text-muted">
            Examples:<br>
            - Bedrock: anthropic.claude-3-haiku-20240307-v1:0<br>
            - OpenAI: gpt-4o-mini<br>
            - Anthropic: claude-3-5-sonnet-20241022
        </small>
    </div>

    <div class="mb-3">
        <label for="llm_api_base" class="form-label">API Base URL (Optional)</label>
        <input type="text" class="form-control" name="llm_api_base" id="llm_api_base"
            value="{{ config.get('llm_api_base', '') }}" placeholder="https://api.openai.com/v1">
        <small class="form-text text-muted">Only needed for custom OpenAI-compatible endpoints</small>
    </div>

    <button type="submit" class="btn btn-primary">Save Configuration</button>
</form>

<div class="alert alert-info">
    <h5>Current Configuration:</h5>
    <ul class="mb-0">
        <li><strong>Provider:</strong> {{ config.get('llm_provider', 'bedrock') }}</li>
        <li><strong>Model:</strong> {{ config.get('llm_model', 'anthropic.claude-3-haiku-20240307-v1:0') }}</li>
        <li><strong>API Key:</strong> {{ '***' if config.get('llm_api_key') else 'Not set' }}</li>
        <li><strong>API Base:</strong> {{ config.get('llm_api_base', 'Default') }}</li>
    </ul>
</div>
{% endblock %}